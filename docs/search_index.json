[
["first-cohort.html", "Chapter 1 First cohort of FSHD and control plasma samples identifies complement components elevated in FSHD plasma 1.1 Demographic distribution 1.2 Statistics testing", " Chapter 1 First cohort of FSHD and control plasma samples identifies complement components elevated in FSHD plasma The first cohort consists of 24 FSHD and 12 control plasma samples. In this chapter, we compared the protein levels of complement components in FSHDs and controls from the first cohort. The tested complement components included six components of the classical/lectin activation pathway (C1q, C4, MBL, C4a, C2, C4b), four of the alternative pathway (Factor H, Factor I, Factor D, Factor B), and four of the terminal effector pathway (C3, C5, C5a, sC5b-9). suppressPackageStartupMessages(library(tidyverse)) suppressPackageStartupMessages(library(wesanderson)) suppressPackageStartupMessages(library(ggrepel)) suppressPackageStartupMessages(library(kableExtra)) suppressPackageStartupMessages(library(knitr)) suppressPackageStartupMessages(library(ggfortify)) suppressPackageStartupMessages(library(broom)) suppressPackageStartupMessages(library(pheatmap)) suppressPackageStartupMessages(library(viridis)) suppressPackageStartupMessages(library(pheatmap)) suppressPackageStartupMessages(library(latex2exp)) pkg_dir &lt;- &quot;~/CompBio/Wellstone_Plasma_Complement_in_FSHD&quot; source(file.path(pkg_dir, &quot;scripts&quot;, &quot;tools.R&quot;)) fig_dir &lt;- file.path(pkg_dir, &quot;figures&quot;) cohort1 &lt;- get(load(file.path(pkg_dir, &quot;data&quot;, &quot;table_1.rda&quot;))) components &lt;- c(&quot;C2&quot;, &quot;C4b&quot;, &quot;C5&quot;, &quot;C5a&quot;, &quot;Factor D&quot;, &quot;MBL&quot;, &quot;Factor I&quot;, &quot;C1q&quot;, &quot;C3&quot;, &quot;C4&quot;, &quot;Factor B&quot;, &quot;Factor H&quot;, &quot;C4a&quot;, &quot;sC5b-9&quot;) my_color &lt;- viridis_pal(direction = -1)(8)[c(3, 6)] # control and FSHD names(my_color) &lt;- c(&quot;Control&quot;, &quot;FSHD&quot;) mean_color &lt;- &quot;#FF0000&quot; #my_color &lt;- c(Control=&quot;#31A345&quot;, FSHD=&quot;#3182BD&quot;) 1.1 Demographic distribution Age distribution of FSHD cohort1 %&gt;% filter(`pheno type`==&quot;FSHD&quot;) %&gt;% summarise(min=min(`Visit Age`), max=max(`Visit Age`), mean=mean(`Visit Age`), sd=sd(`Visit Age`)) %&gt;% knitr::kable(caption=&quot;FSHD: age distribution -- min, max, mean, and standard deviation. &quot;) Table 1.1: FSHD: age distribution – min, max, mean, and standard deviation. min max mean sd 18 72 52.04458 14.88034 Age distribution of controls cohort1 %&gt;% filter(`pheno type`==&quot;Control&quot;) %&gt;% summarise(min=min(`Visit Age`), max=max(`Visit Age`), mean=mean(`Visit Age`), sd=sd(`Visit Age`)) %&gt;% knitr::kable(caption=&quot;Control: age distribution -- min, max, mean, and standard deviation.&quot;) Table 1.2: Control: age distribution – min, max, mean, and standard deviation. min max mean sd 21 63 45.33333 15.11972 Gender distribution of FSHD cohort1 %&gt;% filter(`pheno type`==&quot;FSHD&quot;) %&gt;% summarize(male = sum(`Sex` == &quot;M&quot;) / nrow(.), female = sum(`Sex` == &quot;F&quot;) / nrow(.)) %&gt;% knitr::kable(caption=&quot;FSHD gender distribution.&quot;) Table 1.3: FSHD gender distribution. male female 0.5 0.5 Gender distribution of Controls cohort1 %&gt;% filter(`pheno type`==&quot;Control&quot;) %&gt;% summarize(male = sum(`Sex` == &quot;M&quot;) / nrow(.), female = sum(`Sex` == &quot;F&quot;) / nrow(.)) %&gt;% knitr::kable(caption=&quot;Control gender distribution.&quot;) Table 1.4: Control gender distribution. male female 0.5 0.5 1.2 Statistics testing The \\(t\\)-test comparing FSHDs and controls rendered three components, sC5b-9, C3, and C2, showing increased levels in FSHD. The code chunks below perform \\(t\\)-testing comparing the complement components in FSHD and control groups barplot of p-values (Figure 1.1; Fig. 2a) and complement levels distribution in each group (Figure 1.2; Fig. 2b) heatmap and hierarchical cluster analysis (Figure 1.3; Suppl. Fig. S1) # use .tidy_names() from scripts/tools.R&quot; to tidy the name of cohort1 cohort1_tidy &lt;- .tidy_names(cohort1) %&gt;% select(-Bb) %&gt;% select(`sample ID`, pheno_type, all_of(components)) %&gt;% gather(key=complement, value=ml, -`sample ID`, -pheno_type) cohort1_tidy_norm &lt;- cohort1_tidy %&gt;% group_by(complement) %&gt;% group_modify( ~.z_norm(.x)) 1.2.1 t-tests cohort1_ttest &lt;- cohort1_tidy %&gt;% mutate(pheno_type = factor(pheno_type)) %&gt;% group_by(complement) %&gt;% spread(key=pheno_type, ml) %&gt;% summarize(control_mu = mean(Control, na.rm=TRUE), control_sd = sd(Control, na.rm=TRUE), FSHD_mu = mean(FSHD, na.rm=TRUE), FSHD_sd = sd(FSHD, na.rm=TRUE), #wilcox_test = wilcox.test(FSHD, Control)$p.value, t_test = t.test(FSHD, Control)$p.value, t_stats = t.test(FSHD, Control)$statistic) %&gt;% mutate(log10Pval = -10 * log10(t_test)) %&gt;% mutate(log10Pval = ifelse(t_stats &lt; 0, -log10Pval, log10Pval)) %&gt;% mutate(candidate = ifelse(t_test &lt; 0.05, &quot;Yes&quot;, &quot;No&quot;)) %&gt;% arrange(desc(t_test)) %&gt;% mutate(complement=factor(complement, levels=complement)) %&gt;% mutate(formated_p = format(t_test, digits=1)) ggplot(cohort1_ttest, aes(x=complement, y=log10Pval, fill=candidate)) + geom_bar(stat=&quot;identity&quot;, width=0.7, show.legend=FALSE) + coord_flip() + scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;)) + theme_bw() + labs(title=TeX(&quot;First cohort: $t$-tests&quot;), x=&quot;Complements&quot;, y=TeX(&quot;$-10\\\\log_{10}(\\\\mathit{p}-val) \\\\times sign(\\\\mathit{t}-stats)$&quot;)) + #y=expression(-10*Log[10](p-value) %*% sign(t-stats))) + geom_text(aes(label=formated_p), vjust=0.5, hjust=0.5, color=&quot;gray10&quot;, position = position_dodge(1), size=2.5) + theme(panel.grid.major = element_blank()) Figure 1.1: Cohort1 per-compoment t-tests: FSHD vs. controls. Annotation refers to p-values. * negative -10Log10(p-value) indicates negative t-statistics. ggsave(file=file.path(pkg_dir, &quot;figures&quot;, &quot;cohort1-ttest-pvalue-bar.pdf&quot;), width=3, height=2.5) 1.2.2 Violin plot of 14 complement components measurements cohort1_tidy %&gt;% ggplot(aes(x=pheno_type, y=ml)) + geom_violin(aes(color=pheno_type), width=0.7) + geom_dotplot(binaxis=&#39;y&#39;, stackdir=&#39;center&#39;, dotsize=1, aes(color=pheno_type, fill=pheno_type), alpha=0.7, show.legend=FALSE) + stat_summary(fun=mean, geom=&quot;point&quot;, shape=23, size=2.5, color=&quot;#FF0000&quot;) + theme_minimal() + labs( y=expression(mu*g / ml), title=&quot;First cohort complement components&quot;) + facet_wrap(~ complement , scale=&quot;free&quot;, nrow=3) + scale_fill_manual(values=my_color) + scale_color_manual(values=my_color) + theme(legend.position=c(0.9, 0.15), legend.key.size = unit(0.4, &#39;cm&#39;), axis.title.x=element_blank(), axis.text.x=element_blank()) Figure 1.2: 14 complement components measurements grouped by FSHD and control samples. ggsave(file=file.path(pkg_dir, &quot;figures&quot;, &quot;cohort1-violin-14components.pdf&quot;), width=4.5, height=4.5) 1.2.3 Heatmap and cluster analysis norm_data &lt;- cohort1_tidy_norm %&gt;% select(-ml) %&gt;% spread(complement, ml_norm) # outlier F11&#39;s C2 = 14.46, replace with NA to avoid the color skew norm_data[which(norm_data$`sample ID` ==&quot;F11&quot;), &quot;C2&quot;] &lt;- NA mat &lt;- norm_data %&gt;% select(-`sample ID`, -pheno_type) %&gt;% as.matrix() rownames(mat) &lt;- pull(norm_data, `sample ID`) # annotation annotation_row &lt;- data.frame(pheno_type=factor(pull(norm_data, `pheno_type`))) rownames(annotation_row) &lt;- rownames(mat) annotation_colors &lt;- list(pheno_type=my_color) # heatmap pheatmap(mat, annotation_row=annotation_row, scale=&quot;none&quot;, fontsize=10, annotation_colors=annotation_colors) Figure 1.3: Cohort1: heatmap of the normalized matrix. "]
]
