[
["second-cohort.html", "Chapter 2 Complement assays in a second cohort confirms elevation of complement components 2.1 Demographic distribution 2.2 Statistics testing 2.3 Controls from two cohorts 2.4 Stability of FSHDs between two visits", " Chapter 2 Complement assays in a second cohort confirms elevation of complement components The second cohort consists of 41 FSHD subjects and 17 controls. Here, we performed a parallel analysis, as for the first cohort, on 15 tested components including Bb, C2, C4b, C5, C5a, Factor D, MBL, Factor I, C1q, C3, C4, Factor B, Factor H, C4a, sC5b-9. suppressPackageStartupMessages(library(tidyverse)) suppressPackageStartupMessages(library(wesanderson)) suppressPackageStartupMessages(library(ggrepel)) suppressPackageStartupMessages(library(kableExtra)) suppressPackageStartupMessages(library(knitr)) suppressPackageStartupMessages(library(ggfortify)) suppressPackageStartupMessages(library(broom)) suppressPackageStartupMessages(library(pheatmap)) suppressPackageStartupMessages(library(viridis)) suppressPackageStartupMessages(library(pheatmap)) suppressPackageStartupMessages(library(latex2exp)) pkg_dir &lt;- &quot;~/CompBio/Wellstone_Plasma_Complement_in_FSHD&quot; source(file.path(pkg_dir, &quot;scripts&quot;, &quot;tools.R&quot;)) fig_dir &lt;- file.path(pkg_dir, &quot;figures&quot;) # cohort2 specific cohort2 &lt;- get(load(file.path(pkg_dir, &quot;data&quot;, &quot;table_2.rda&quot;))) components &lt;- c(&quot;Bb&quot;, &quot;C2&quot;, &quot;C4b&quot;, &quot;C5&quot;, &quot;C5a&quot;, &quot;Factor D&quot;, &quot;MBL&quot;, &quot;Factor I&quot;, &quot;C1q&quot;, &quot;C3&quot;, &quot;C4&quot;, &quot;Factor B&quot;, &quot;Factor H&quot;, &quot;C4a&quot;, &quot;sC5b-9&quot;) my_color &lt;- viridis_pal(direction = -1)(8)[c(3, 6)] # control and FSHD names(my_color) &lt;- c(&quot;Control&quot;, &quot;FSHD&quot;) mean_color &lt;- &quot;#FF0000&quot; 2.1 Demographic distribution Age distribution of FSHD cohort2 %&gt;% filter(`pheno type`==&quot;FSHD&quot;) %&gt;% summarise(min=min(`Visit Age`), max=max(`Visit Age`), mean=mean(`Visit Age`), sd=sd(`Visit Age`)) %&gt;% knitr::kable(caption=&quot;FSHDs age distribution.&quot;) Table 2.1: FSHDs age distribution. min max mean sd 19.8 72.17 55.19024 12.99595 Age distribution of controls cohort2 %&gt;% filter(`pheno type`==&quot;Control&quot;) %&gt;% summarise(min=min(`Visit Age`), max=max(`Visit Age`), mean=mean(`Visit Age`), sd=sd(`Visit Age`)) %&gt;% knitr::kable(caption=&quot;Controls age distribution&quot;) Table 2.2: Controls age distribution min max mean sd 18 71 45.76471 15.91591 Gender distribution of FSHD cohort2 %&gt;% filter(`pheno type`==&quot;FSHD&quot;) %&gt;% summarize(male = sum(`Sex` == &quot;M&quot;) / nrow(.), female = sum(`Sex` == &quot;F&quot;) / nrow(.)) %&gt;% knitr::kable(caption=&quot;FSHDs gender distribution&quot;) Table 2.3: FSHDs gender distribution male female 0.3902439 0.6097561 Gender distribution of Controls cohort2 %&gt;% filter(`pheno type`==&quot;Control&quot;) %&gt;% summarize(male = sum(`Sex` == &quot;M&quot;) / nrow(.), female = sum(`Sex` == &quot;F&quot;) / nrow(.)) %&gt;% knitr::kable(caption=&quot;Controls gender distribution.&quot;) Table 2.4: Controls gender distribution. male female 0.3529412 0.6470588 2.2 Statistics testing In the second cohort, C4b and C3 significantly increased in FHSD, and Bb and C4b are moderately increased. The code chunks below perform - \\(t\\)-testing comparing the complement components in FSHD and control groups - visualization of p-values (Figure \\2bar plot; Fig. 3a) and complement levels distribution in each group (violin plot; Fig. 3b) # use .tidy_names() from scripts/tools.R&quot; to tidy the name of cohort1 cohort2_tidy &lt;- .tidy_names(cohort2) %&gt;% select(`sample ID`, pheno_type, components) %&gt;% gather(key=complement, value=ml, -`sample ID`, -pheno_type) cohort2_tidy_norm &lt;- cohort2_tidy %&gt;% group_by(complement) %&gt;% group_modify( ~.z_norm(.x)) 2.2.1 t-tests cohort2_ttest &lt;- cohort2_tidy %&gt;% mutate(pheno_type = factor(pheno_type)) %&gt;% group_by(complement) %&gt;% spread(key=pheno_type, ml) %&gt;% summarize(control_mu = mean(Control, na.rm=TRUE), control_sd = sd(Control, na.rm=TRUE), FSHD_mu = mean(FSHD, na.rm=TRUE), FSHD_sd = sd(FSHD, na.rm=TRUE), #wilcox_test = wilcox.test(FSHD, Control)$p.value, t_test = t.test(FSHD, Control)$p.value, t_stats = t.test(FSHD, Control)$statistic) %&gt;% mutate(log10Pval = -10 * log10(t_test)) %&gt;% mutate(log10Pval = ifelse(t_stats &lt; 0, -log10Pval, log10Pval)) %&gt;% mutate(candidate = ifelse(t_test &lt; 0.05, &quot;Yes&quot;, &quot;No&quot;)) %&gt;% arrange(desc(t_test)) %&gt;% mutate(complement=factor(complement, levels=complement)) %&gt;% mutate(formated_p = format(t_test, digit=1)) ggplot(cohort2_ttest, aes(x=complement, y=log10Pval, fill=candidate)) + geom_bar(stat=&quot;identity&quot;, width=0.7, show.legend=FALSE) + coord_flip() + scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;)) + theme_bw() + labs(title=TeX(&quot;Second cohort: $t$-tests&quot;), x=&quot;Complements&quot;, y=TeX(&quot;$-10\\\\log_{10}(\\\\mathit{p}-val) \\\\times sign(\\\\mathit{t}-stats)$&quot;)) + geom_text(aes(label=formated_p), vjust=0.5, hjust=0.6, color=&quot;gray10&quot;, position = position_dodge(1), size=2.5) + theme(panel.grid.major = element_blank()) Figure 2.1: Cohort2 per-compoment t-tests: FSHD vs. controls. * negative -10Log10(p-value) indicates negative t-statistics. ggsave(file=file.path(pkg_dir, &quot;figures&quot;, &quot;cohort2-ttest-pvalue-bar.pdf&quot;), width=3.2, height=2.5) 2.2.2 Violin plot of 15 complement components measurements cohort2_tidy %&gt;% ggplot(aes(x=pheno_type, y=ml)) + geom_violin(aes(color=pheno_type), width=0.7) + geom_dotplot(binaxis=&#39;y&#39;, stackdir=&#39;center&#39;, dotsize=1, aes(color=pheno_type, fill=pheno_type), alpha=0.7, show.legend=FALSE) + stat_summary(fun=mean, geom=&quot;point&quot;, shape=23, size=2.5, color=&quot;#FF0000&quot;) + theme_minimal() + labs( y=expression(mu*g / ml), title=&quot;Second cohort complement components&quot;) + facet_wrap(~ complement , scale=&quot;free&quot;, nrow=3) + scale_fill_manual(values=my_color) + scale_color_manual(values=my_color) + theme(legend.position=c(0.9, 0.15), legend.key.size = unit(0.4, &#39;cm&#39;), axis.title.x=element_blank(), axis.text.x=element_blank()) Figure 2.2: 14 complement components measurements grouped by FSHD and control samples. ggsave(file=file.path(pkg_dir, &quot;figures&quot;, &quot;cohort2-violin-15components.pdf&quot;), width=4.5, height=4.5) 2.3 Controls from two cohorts Shown below is a violin plot of complement component levels in controls from first and second cohorts. Code chunk below made Suppl. Fig. 2a. # get cohort1 and tidy up the control samples from 1st and 2nd cohorts cohort1 &lt;- get(load(file.path(pkg_dir, &quot;data&quot;, &quot;table_1.rda&quot;))) cohort1_control &lt;- .tidy_names(cohort1) %&gt;% filter(pheno_type==&quot;Control&quot;) %&gt;% select(`sample ID`, components, Cohort) %&gt;% gather(key=complement, value=ml, -`sample ID`, -Cohort) cohort2_control &lt;- .tidy_names(cohort2) %&gt;% filter(pheno_type==&quot;Control&quot;) %&gt;% select(`sample ID`, components, Cohort) %&gt;% gather(key=complement, value=ml, -`sample ID`, -Cohort) control_tidy &lt;- bind_rows(cohort1_control, cohort2_control) %&gt;% filter(complement !=&quot;Bb&quot;) ggplot(control_tidy, aes(x=Cohort, y=ml)) + geom_violin(aes(color=Cohort), width=0.7,na.rm=TRUE) + geom_dotplot(binaxis=&#39;y&#39;, na.rm=TRUE, stackdir=&#39;center&#39;, dotsize=1, aes(color=Cohort, fill=Cohort), alpha=0.7, show.legend=FALSE) + stat_summary(fun=mean, geom=&quot;point&quot;, shape=23, size=2, color=mean_color) + theme_minimal() + labs(title=&quot;Controls&quot;, y=expression(mu*g / ml)) + facet_wrap(~ complement, nrow=3, scale=&quot;free&quot;) + scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;)) + scale_color_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;)) + theme(legend.position = c(0.9, 0.15), legend.key.size = unit(0.4, &#39;cm&#39;), axis.text.x=element_blank(), axis.title.x=element_blank()) Figure 2.3: Complement levels of controls from two cohorts. The violin plots display the distribution of the plasma levels by cohorts. The gray dots represent the complement levels in the pilot cohort (cohort1) and the yellow dots in the second cohort (cohort2). The red dots are the mean values in each cohort. ggsave(file.path(pkg_dir, &quot;figures&quot;, &quot;controls-two-cohorts-violin.pdf&quot;), height=4, width=6) 2.4 Stability of FSHDs between two visits The FSHD subjects’ first and the second visits are named plasma1 and plasma2 respectively. We made a trajectory plot – plasma 1 to plasma 2 – for each of the complement component. There are total 41 FSHD subjects (41 dots on plasma 1) and only 20 have the second visits. The code chuck below reproduce Suppl. Fig. 2b. The cohort2_pairs &lt;- get(load(file.path(pkg_dir, &quot;data&quot;, &quot;table_4_update.rda&quot;))) %&gt;% .tidy_names(.) %&gt;% filter(Cohort == &quot;cohort2&quot;, pheno_type == &quot;FSHD&quot;) %&gt;% select(`sample ID`, components, Plasma, `patient ID`) %&gt;% gather(key=complement, value=ml, -`sample ID`, -Plasma, -`patient ID`) # control ranges cntr2_rng &lt;- cohort2_tidy %&gt;% filter(pheno_type==&quot;Control&quot;) %&gt;% group_by(complement) %&gt;% summarise(min=min(ml, na.rm=TRUE), max=max(ml, na.rm=TRUE)) %&gt;% ungroup() ggplot(cohort2_pairs, aes(x=Plasma, y=ml)) + geom_point(aes(color=Plasma), size=2, show.legend=FALSE) + geom_line(aes(group=`patient ID`), color=&quot;gray50&quot;, show.legend=FALSE) + theme_bw() + geom_boxplot(width = 0.3, aes(color=Plasma), fill=&quot;transparent&quot;, show.legend=FALSE) + geom_rect(data=cntr2_rng, inherit.aes=FALSE, aes(xmin=-Inf, xmax=Inf, ymin=min, ymax=max), fill=&quot;gray50&quot;, colour=NA, alpha=0.2) + scale_color_manual(values=c(&quot;#4AC16DFF&quot;, &quot;#365C8DFF&quot;)) + facet_wrap(~complement, nrow=3, scale=&quot;free&quot;) + labs(title=&quot;Cohort2: plasma1 vs. plasma2&quot;, y=expression(mu*g / ml)) Figure 2.4: A trajectory plot of complement levels between the first (plasma1) and second (plasma2) plasma samples of individuals. The gray area presents the range of complement levels in the second cohort’s controls. ggsave(file.path(pkg_dir, &quot;figures&quot;, &quot;Cohort2-plasma-pairs-trajectoryplot.pdf&quot;), width=7.5, height=6) all_cohort2_visits &lt;- get(load(file.path(pkg_dir, &quot;data&quot;, &quot;table_4_update.rda&quot;))) %&gt;% .tidy_names(.) %&gt;% filter(Cohort == &quot;cohort2&quot;, pheno_type == &quot;FSHD&quot;) %&gt;% select(`sample ID`, components, Plasma, `patient ID`) paired_ID &lt;- all_cohort2_visits %&gt;% filter(Plasma == &quot;plasma2&quot;) %&gt;% pull(`patient ID`) paired &lt;- all_cohort2_visits %&gt;% filter(`patient ID` %in% paired_ID) %&gt;% select(-`sample ID`) %&gt;% gather(key=complement, value=ml, -Plasma, -`patient ID`) %&gt;% spread(Plasma, ml) lm_eqn &lt;- function(df){ m &lt;- lm(plasma2 ~ plasma1, df); eq &lt;- substitute(italic(y) == a + b %.% italic(x)*&quot;,&quot;~~italic(r)~&quot;=&quot;~r2, list(a = format(unname(coef(m)[1]), digits = 2), b = format(unname(coef(m)[2]), digits = 2), r2 = format(sqrt(summary(m)$r.squared), digits = 3))) data.frame(label=as.character(as.expression(eq))) } lm_r2 &lt;- function(df) { m &lt;- lm(plasma2 ~ plasma1, df) r &lt;- format(sqrt(summary(m)$r.squared), digits = 3) data.frame(label=paste0(&quot;r=&quot;, r)) } lm_2 &lt;- paired %&gt;% group_by(complement) %&gt;% group_modify( ~ lm_r2(.x)) lm &lt;- paired %&gt;% group_by(complement) %&gt;% group_modify(~ broom::tidy(lm(plasma2 ~ plasma1, data = .x))) ggplot(paired, aes(x=plasma1, y=plasma2)) + geom_point() + geom_smooth(method=&quot;lm&quot;, se=FALSE) + facet_wrap(~ complement, nrow=3, scale=&quot;free&quot;) + geom_abline(slope=1, intercept=0, linetype=&quot;dashed&quot;) + theme_minimal() + geom_text( size = 4, data = lm_2, mapping = aes(x = Inf, y = Inf, label = label), hjust = 1.7, vjust = 1.5 ) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) ggsave(file.path(pkg_dir, &quot;figures&quot;, &quot;Cohort2-plasma-pairs-scatterplot.pdf&quot;), width=7.5, height=6) note: higher R-squared values represent smaller differences between the observed data and the fitted values. note: in linear regression model, the p-value for each term tests the null hypothesis that the coefficient (slope) is equal to zero (no effect). A low p-value (&lt; 0.05) indicates that you can reject the null hypothesis. In other words, a low p-value indicates the changes in the predictor’s (plasma2) value are related to changes in the response variable (plasma1). Conversely, a larger (insignificant) p-value suggests that changes in the predictor are not associated with changes in the response. #broom::tidy paired %&gt;% group_by(complement) %&gt;% group_modify(~ broom::glance(lm(plasma2 ~ plasma1, data = .x))) %&gt;% knitr::kable() complement r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC deviance df.residual nobs Bb 0.6762489 0.6582627 0.1368799 37.598268 0.0000086 1 12.447863 -18.89573 -15.90853 3.372499e-01 18 20 C1q 0.4107782 0.3780437 7.4741645 12.548769 0.0023268 1 -67.554212 141.10842 144.09562 1.005536e+03 18 20 C2 0.4467910 0.4160572 0.8782543 14.537433 0.0012745 1 -24.728784 55.45757 58.44477 1.388395e+01 18 20 C3 0.4015342 0.3682861 14.6801187 12.076905 0.0027015 1 -81.055048 168.11010 171.09729 3.879106e+03 18 20 C4 0.7740760 0.7615247 11.9574930 61.672817 0.0000003 1 -76.952328 159.90466 162.89185 2.573670e+03 18 20 C4a 0.3591547 0.3235522 781.4719494 10.087904 0.0052295 1 -160.548751 327.09750 330.08470 1.099257e+07 18 20 C4b 0.9219415 0.9176050 0.8822639 212.596431 0.0000000 1 -24.819884 55.63977 58.62696 1.401101e+01 18 20 C5 0.9413850 0.9381286 7.2665682 289.088500 0.0000000 1 -66.990848 139.98170 142.96889 9.504542e+02 18 20 C5a 0.9041648 0.8988406 0.1026601 169.822464 0.0000000 1 18.201464 -30.40293 -27.41573 1.897038e-01 18 20 Factor B 0.5788393 0.5554415 14.5282659 24.739035 0.0000983 1 -80.847088 167.69418 170.68137 3.799269e+03 18 20 Factor D 0.7946752 0.7832683 0.1555438 69.666001 0.0000001 1 9.891394 -13.78279 -10.79559 4.354897e-01 18 20 Factor H 0.7669726 0.7540267 13.8459725 59.244152 0.0000004 1 -79.885053 165.77011 168.75730 3.450797e+03 18 20 Factor I 0.8183616 0.8082706 2.4288906 81.097982 0.0000000 1 -45.073858 96.14772 99.13491 1.061912e+02 18 20 MBL 0.9382732 0.9348440 0.1574369 273.607760 0.0000000 1 9.649445 -13.29889 -10.31169 4.461548e-01 18 20 sC5b-9 0.2139320 0.1702616 61.2278554 4.898782 0.0400307 1 -109.617210 225.23442 228.22162 6.747930e+04 18 20 "]
]
