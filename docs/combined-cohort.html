<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Combined cohort | Elevated plasma complement components in facioscapulohumeral dystrophy</title>
  <meta name="description" content="analysis workflow and R codes supporting the manuscript - Elevated plasma complement components in facioscapulohumeral dystrophy" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Combined cohort | Elevated plasma complement components in facioscapulohumeral dystrophy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="analysis workflow and R codes supporting the manuscript - Elevated plasma complement components in facioscapulohumeral dystrophy" />
  <meta name="github-repo" content="FredHutch/Wellstone_Plasma_Complement_in_FSHD" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Combined cohort | Elevated plasma complement components in facioscapulohumeral dystrophy" />
  
  <meta name="twitter:description" content="analysis workflow and R codes supporting the manuscript - Elevated plasma complement components in facioscapulohumeral dystrophy" />
  

<meta name="author" content="Chao-Jen Wong" />


<meta name="date" content="2021-11-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="second-cohort.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#system-requirement-and-software"><i class="fa fa-check"></i><b>0.1</b> System requirement and software</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#samples-and-datasets"><i class="fa fa-check"></i><b>0.2</b> Samples and datasets</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#methods"><i class="fa fa-check"></i><b>0.3</b> Methods</a><ul>
<li class="chapter" data-level="0.3.1" data-path="index.html"><a href="index.html#normalization"><i class="fa fa-check"></i><b>0.3.1</b> Normalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="first-cohort.html"><a href="first-cohort.html"><i class="fa fa-check"></i><b>1</b> First cohort of FSHD and control plasma samples identifies complement components elevated in FSHD plasma</a><ul>
<li class="chapter" data-level="1.1" data-path="first-cohort.html"><a href="first-cohort.html#demographic-distribution"><i class="fa fa-check"></i><b>1.1</b> Demographic distribution</a></li>
<li class="chapter" data-level="1.2" data-path="first-cohort.html"><a href="first-cohort.html#statistics-testing"><i class="fa fa-check"></i><b>1.2</b> Statistics testing</a><ul>
<li class="chapter" data-level="1.2.1" data-path="first-cohort.html"><a href="first-cohort.html#t-tests"><i class="fa fa-check"></i><b>1.2.1</b> t-tests</a></li>
<li class="chapter" data-level="1.2.2" data-path="first-cohort.html"><a href="first-cohort.html#violin-plot-of-14-complement-components-measurements"><i class="fa fa-check"></i><b>1.2.2</b> Violin plot of 14 complement components measurements</a></li>
<li class="chapter" data-level="1.2.3" data-path="first-cohort.html"><a href="first-cohort.html#heatmap-and-cluster-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Heatmap and cluster analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="second-cohort.html"><a href="second-cohort.html"><i class="fa fa-check"></i><b>2</b> Complement assays in a second cohort confirms elevation of complement components</a><ul>
<li class="chapter" data-level="2.1" data-path="second-cohort.html"><a href="second-cohort.html#demographic-distribution-1"><i class="fa fa-check"></i><b>2.1</b> Demographic distribution</a></li>
<li class="chapter" data-level="2.2" data-path="second-cohort.html"><a href="second-cohort.html#statistics-testing-1"><i class="fa fa-check"></i><b>2.2</b> Statistics testing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="second-cohort.html"><a href="second-cohort.html#t-tests-1"><i class="fa fa-check"></i><b>2.2.1</b> t-tests</a></li>
<li class="chapter" data-level="2.2.2" data-path="second-cohort.html"><a href="second-cohort.html#violin-plot-of-15-complement-components-measurements"><i class="fa fa-check"></i><b>2.2.2</b> Violin plot of 15 complement components measurements</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="second-cohort.html"><a href="second-cohort.html#controls-from-two-cohorts"><i class="fa fa-check"></i><b>2.3</b> Controls from two cohorts</a></li>
<li class="chapter" data-level="2.4" data-path="second-cohort.html"><a href="second-cohort.html#stability-of-fshds-between-two-visits"><i class="fa fa-check"></i><b>2.4</b> Stability of FSHDs between two visits</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="combined-cohort.html"><a href="combined-cohort.html"><i class="fa fa-check"></i><b>3</b> Combined cohort</a><ul>
<li class="chapter" data-level="3.1" data-path="combined-cohort.html"><a href="combined-cohort.html#explore-components-best-distinguish-fshd-from-controls"><i class="fa fa-check"></i><b>3.1</b> Explore components best distinguish FSHD from controls</a><ul>
<li class="chapter" data-level="3.1.1" data-path="combined-cohort.html"><a href="combined-cohort.html#t-test"><i class="fa fa-check"></i><b>3.1.1</b> <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="3.1.2" data-path="combined-cohort.html"><a href="combined-cohort.html#correlation-tests"><i class="fa fa-check"></i><b>3.1.2</b> Correlation tests</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="combined-cohort.html"><a href="combined-cohort.html#panel-of-seven---classification-and-composite-z-score"><i class="fa fa-check"></i><b>3.2</b> Panel of seven - Classification and composite z-score</a><ul>
<li class="chapter" data-level="3.2.1" data-path="combined-cohort.html"><a href="combined-cohort.html#boxplot-by-sample-groups"><i class="fa fa-check"></i><b>3.2.1</b> Boxplot by sample groups</a></li>
<li class="chapter" data-level="3.2.2" data-path="combined-cohort.html"><a href="combined-cohort.html#heatmapclustering"><i class="fa fa-check"></i><b>3.2.2</b> Heatmap/clustering</a></li>
<li class="chapter" data-level="3.2.3" data-path="combined-cohort.html"><a href="combined-cohort.html#composite-z-score"><i class="fa fa-check"></i><b>3.2.3</b> Composite z-score</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="combined-cohort.html"><a href="combined-cohort.html#panel-of-four---classification-and-composite-z-scores"><i class="fa fa-check"></i><b>3.3</b> Panel of four - Classification and composite z-scores</a><ul>
<li class="chapter" data-level="3.3.1" data-path="combined-cohort.html"><a href="combined-cohort.html#boxplot-by-sample-groups-1"><i class="fa fa-check"></i><b>3.3.1</b> Boxplot by sample groups</a></li>
<li class="chapter" data-level="3.3.2" data-path="combined-cohort.html"><a href="combined-cohort.html#heatmapclustering-1"><i class="fa fa-check"></i><b>3.3.2</b> Heatmap/clustering</a></li>
<li class="chapter" data-level="3.3.3" data-path="combined-cohort.html"><a href="combined-cohort.html#composite-z-score-1"><i class="fa fa-check"></i><b>3.3.3</b> Composite z-score</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="combined-cohort.html"><a href="combined-cohort.html#clinical-severity-score-and-d4z4-repeats"><i class="fa fa-check"></i><b>3.4</b> Clinical severity score and D4Z4 repeats</a><ul>
<li class="chapter" data-level="3.4.1" data-path="combined-cohort.html"><a href="combined-cohort.html#css-vs.composite-z-score"><i class="fa fa-check"></i><b>3.4.1</b> CSS vs. composite z-score</a></li>
<li class="chapter" data-level="3.4.2" data-path="combined-cohort.html"><a href="combined-cohort.html#d4z4-vs.composite-z-score"><i class="fa fa-check"></i><b>3.4.2</b> D4Z4 vs. composite z-score</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elevated plasma complement components in facioscapulohumeral dystrophy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="combined-cohort" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Combined cohort</h1>
<p>We made a discovery cohort by combining 41, 12 plasma collected from first cohort at a follow-up visit, and 17 controls sample from the second cohort. Thess plasma samples were all run in the same assay group. Using this cohort, we explored the complement components that are best in distinguishing FSHD from controls.</p>
<p><strong>Summary</strong></p>
<p>The code chunks here reproduced Fig. 4a-c and Suppl. Fig. 3a-d.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(tidyverse))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(ggrepel))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(kableExtra))</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(knitr))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(ggfortify))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(broom))</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(pheatmap))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(viridis))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(pheatmap))</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(latex2exp))</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">pkg_dir &lt;-<span class="st"> &quot;~/CompBio/Wellstone_Plasma_Complement_in_FSHD&quot;</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">source</span>(<span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;scripts&quot;</span>, <span class="st">&quot;tools.R&quot;</span>))</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">fig_dir &lt;-<span class="st"> </span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># get combinded cohort</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">comb &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="kw">load</span>(<span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;table_3.rda&quot;</span>)))</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">components &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Bb&quot;</span>, <span class="st">&quot;C2&quot;</span>, <span class="st">&quot;C4b&quot;</span>, <span class="st">&quot;C5&quot;</span>, <span class="st">&quot;C5a&quot;</span>, <span class="st">&quot;Factor D&quot;</span>, <span class="st">&quot;MBL&quot;</span>, <span class="st">&quot;Factor I&quot;</span>,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">                <span class="st">&quot;C1q&quot;</span>, <span class="st">&quot;C3&quot;</span>, <span class="st">&quot;C4&quot;</span>, <span class="st">&quot;Factor B&quot;</span>, <span class="st">&quot;Factor H&quot;</span>,</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">                <span class="st">&quot;C4a&quot;</span>, <span class="st">&quot;sC5b-9&quot;</span>)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">my_color &lt;-<span class="st"> </span><span class="kw">viridis_pal</span>(<span class="dt">direction =</span> <span class="dv">-1</span>)(<span class="dv">8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">6</span>)] <span class="co"># control and FSHD</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">names</span>(my_color) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;FSHD&quot;</span>)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">mean_color &lt;-<span class="st"> &quot;#FF0000&quot;</span></a></code></pre></div>
<p>First of all, we tidy the dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">comb_tidy &lt;-<span class="st"> </span><span class="kw">.tidy_names</span>(comb) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, pheno_type, components) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key=</span>complement, <span class="dt">value=</span>ml, <span class="op">-</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="op">-</span>pheno_type)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">comb_tidy_norm &lt;-<span class="st"> </span>comb_tidy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(complement) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">  </span><span class="kw">group_modify</span>( <span class="op">~</span><span class="kw">.z_norm</span>(.x))</a></code></pre></div>
<div id="explore-components-best-distinguish-fshd-from-controls" class="section level2">
<h2><span class="header-section-number">3.1</span> Explore components best distinguish FSHD from controls</h2>
<div id="t-test" class="section level3">
<h3><span class="header-section-number">3.1.1</span> <span class="math inline">\(t\)</span>-test</h3>
<p>The <span class="math inline">\(t\)</span>-test result is similar to that of cohort2 – C4b and C3 are significantly elevated (p-value &lt; 0.05). Factor D and Bb are mildly elevated.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">comb_ttest &lt;-<span class="st"> </span>comb_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="co">#mutate(pheno_type = factor(pheno_type)) %&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(complement) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key=</span>pheno_type, ml) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">control_mu =</span> <span class="kw">mean</span>(Control, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">            <span class="dt">control_sd =</span> <span class="kw">sd</span>(Control, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">            <span class="dt">FSHD_mu =</span> <span class="kw">mean</span>(FSHD, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">            <span class="dt">FSHD_sd =</span> <span class="kw">sd</span>(FSHD, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">            <span class="dt">wilcox_test =</span> <span class="kw">wilcox.test</span>(FSHD, Control)<span class="op">$</span>p.value,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">            <span class="dt">t_test =</span> <span class="kw">t.test</span>(FSHD, Control)<span class="op">$</span>p.value,</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">            <span class="dt">t_stats =</span> <span class="kw">t.test</span>(FSHD, Control)<span class="op">$</span>statistic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log10Pval =</span> <span class="dv">-10</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(t_test)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log10Pval =</span> <span class="kw">ifelse</span>(t_stats <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, <span class="op">-</span>log10Pval, log10Pval)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">candidate =</span> <span class="kw">ifelse</span>(t_test <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(t_test)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">complement=</span><span class="kw">factor</span>(complement, <span class="dt">levels=</span>complement)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">formated_p =</span> <span class="kw">format</span>(t_test, <span class="dt">digit=</span><span class="dv">1</span>))</a></code></pre></div>
<p><strong><span class="math inline">\(t\)</span>-test barplot (Suppl. Fig. 3a)</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">ggplot</span>(comb_ttest, <span class="kw">aes</span>(<span class="dt">x=</span>complement, <span class="dt">y=</span>log10Pval, <span class="dt">fill=</span>candidate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span><span class="fl">0.7</span>, <span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">TeX</span>(<span class="st">&quot;Combined cohort: $t$-tests&quot;</span>), <span class="dt">x=</span><span class="st">&quot;Complements&quot;</span>,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">       <span class="dt">y=</span><span class="kw">TeX</span>(<span class="st">&quot;$-10</span><span class="ch">\\</span><span class="st">log_{10}(</span><span class="ch">\\</span><span class="st">mathit{p}-val) </span><span class="ch">\\</span><span class="st">times sign(</span><span class="ch">\\</span><span class="st">mathit{t}-stats)$&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>formated_p), <span class="dt">vjust=</span><span class="fl">0.5</span>, <span class="dt">hjust=</span><span class="fl">0.5</span>, <span class="dt">color=</span><span class="st">&quot;gray10&quot;</span>,</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dv">1</span>), <span class="dt">size=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="figure"><span id="fig:comb-ttest-barplot"></span>
<img src="gitbook_files/figure-html/comb-ttest-barplot-1.png" alt="Combind cohort per-compoment t-tests: FSHD vs. controls. * negative -10Log10(p-value) indicates negative t-statistics." width="672" />
<p class="caption">
Figure 3.1: Combind cohort per-compoment t-tests: FSHD vs. controls. * negative -10Log10(p-value) indicates negative t-statistics.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;comb-cohort-pvalue-bar.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">       <span class="dt">width=</span><span class="fl">5.4</span>, <span class="dt">height=</span><span class="dv">3</span>)  </a></code></pre></div>
</div>
<div id="correlation-tests" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Correlation tests</h3>
<p>We performed Pearson Correlatin test among 15 components on FSHDs in the combined cohort and observed seven highly correlated compoments (Pearson &gt; 0.45) and FSHD-associated (based on t-tests):</p>
<ul>
<li>C3, FactorH and Factor D (alternative pathway focused). Dropped correlated Factor I and B because they are not relatively associated with FSHD levels<br />
</li>
<li>C4/C4b/C5/sC5b-9 (classical pathway focused)</li>
</ul>
<p><strong>correlation code reference</strong>: <a href="https://paulvanderlaken.com/2018/09/10/simpler-correlation-analysis-in-r-using-tidyverse-principles/" class="uri">https://paulvanderlaken.com/2018/09/10/simpler-correlation-analysis-in-r-using-tidyverse-principles/</a></p>
<p>Suppl. Fig. 3b</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">comb_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(<span class="dt">key=</span>complement, <span class="dt">value=</span>ml) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(pheno_type <span class="op">==</span><span class="st"> &quot;FSHD&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(components) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span>corrr<span class="op">::</span><span class="kw">correlate</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span>corrr<span class="op">::</span><span class="kw">shave</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span>corrr<span class="op">::</span><span class="kw">rplot</span>(<span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust=</span><span class="fl">0.95</span>, <span class="dt">vjust=</span><span class="fl">0.2</span>), </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">          <span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:comb-cohort-correlation-plot"></span>
<img src="gitbook_files/figure-html/comb-cohort-correlation-plot-1.png" alt="The correlation matrix among the complement components." width="672" />
<p class="caption">
Figure 3.2: The correlation matrix among the complement components.
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;comb_cohort_complement_corr.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">       <span class="dt">width=</span><span class="dv">5</span>, <span class="dt">height=</span><span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sub_alternative &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor H&quot;</span>, <span class="st">&quot;Factor D&quot;</span>, <span class="st">&quot;C3&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">sub_classical &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;C4&quot;</span>, <span class="st">&quot;C4b&quot;</span>, <span class="st">&quot;C5&quot;</span>, <span class="st">&quot;sC5b-9&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">panel_<span class="dv">7</span> &lt;-<span class="st"> </span><span class="kw">c</span>(sub_alternative, sub_classical)</a></code></pre></div>
<p><strong>Network focused on the seven selected components</strong>:
Suppl. Fig. 3c.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">comb_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(<span class="dt">key=</span>complement, <span class="dt">value=</span>ml) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(pheno_type <span class="op">==</span><span class="st"> &quot;FSHD&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">all_of</span>(panel_<span class="dv">7</span>) )<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span>corrr<span class="op">::</span><span class="kw">correlate</span>(., <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>, <span class="dt">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span>corrr<span class="op">::</span><span class="kw">network_plot</span>(<span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">legend=</span><span class="ot">FALSE</span>) </a></code></pre></div>
<div class="figure"><span id="fig:comb-cohort-correlation-network-focus"></span>
<img src="gitbook_files/figure-html/comb-cohort-correlation-network-focus-1.png" alt="Correlation network among the seven highly correlated complement components. The scaled color represents the Pearson correlation." width="672" />
<p class="caption">
Figure 3.3: Correlation network among the seven highly correlated complement components. The scaled color represents the Pearson correlation.
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                      <span class="st">&quot;comb-cohort-corr-network-focus.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">       <span class="dt">width=</span><span class="dv">3</span>, <span class="dt">height=</span><span class="dv">2</span>)</a></code></pre></div>
</div>
</div>
<div id="panel-of-seven---classification-and-composite-z-score" class="section level2">
<h2><span class="header-section-number">3.2</span> Panel of seven - Classification and composite z-score</h2>
<p>The correlation and t-tests together revealed seven complement components (Factor H, Factor D, C3, C4, C4b, C5, sC5b-9) that are showing stronger association with FHSD than other components. Here we used these seven complement levels to (1) classify the FSHD samples by hierarchical cluster analysis and (2) construct per-sample composite z-scores.</p>
<p>The code chunks below made Suppl. Fig. 3d-g (boxplots, heatmap, waterfall, composite z-score boxplot).</p>
<div id="boxplot-by-sample-groups" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Boxplot by sample groups</h3>
<p><strong>boxplot:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">comb_tidy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(complement <span class="op">%in%</span><span class="st"> </span><span class="kw">all_of</span>(panel_<span class="dv">7</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pheno_type, <span class="dt">y=</span>ml)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">color=</span>pheno_type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                 <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>, <span class="dt">dotsize=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">                 <span class="kw">aes</span>(<span class="dt">color=</span>pheno_type, <span class="dt">fill=</span>pheno_type), </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                 <span class="dt">alpha=</span><span class="fl">0.7</span>, <span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun=</span>mean, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">23</span>, <span class="dt">size=</span><span class="fl">2.5</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">                 <span class="dt">color=</span>mean_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>complement , <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb11-16" data-line-number="16">          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(mu<span class="op">*</span>g <span class="op">/</span><span class="st"> </span>ml)) </a></code></pre></div>
<div class="figure"><span id="fig:comb-cohort-boxplot-panel7"></span>
<img src="gitbook_files/figure-html/comb-cohort-boxplot-panel7-1.png" alt="Violin plot of the panel of seven by sample groups." width="672" />
<p class="caption">
Figure 3.4: Violin plot of the panel of seven by sample groups.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                      <span class="st">&quot;comb-cohort-violin-panel7-boxplot.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">       <span class="dt">width=</span><span class="dv">6</span>, <span class="dt">height=</span><span class="dv">4</span>)</a></code></pre></div>
</div>
<div id="heatmapclustering" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Heatmap/clustering</h3>
<p>Using hierarchical cluster and heatmap visualization, we observed a subset of 12 FSHD samples have elevated levels in the classical pathway and terminal components (C4, C4b, C5, and sC5b-9), and 7 in alternative pathway (C3, Factor H/D). Together these 19 FSHDs are labelled as “elevated” FSHD. Based on the panel of 7 factors, we made heatmap showing the clusters and PCA depicting the simple sample distance among all the samples.</p>
<p>Note Control C20 (ID=“3170”) shows the characteristics of elevated FSHDs, and cluster with the FHSDs.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># the rows could be re-arrange by defined clusters (cold fhsd, hot on terminal and alternative)</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">norm_data &lt;-<span class="st"> </span>comb_tidy_norm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>ml) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">spread</span>(complement, ml_norm) </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">mat &lt;-<span class="st"> </span>norm_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">all_of</span>(panel_<span class="dv">7</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">rownames</span>(mat) &lt;-<span class="st"> </span>norm_data<span class="op">$</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">annotation_row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pheno_type=</span><span class="kw">factor</span>(<span class="kw">pull</span>(norm_data, <span class="st">`</span><span class="dt">pheno_type</span><span class="st">`</span>)))</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">rownames</span>(annotation_row) &lt;-<span class="st"> </span><span class="kw">rownames</span>(mat)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">annotation_colors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">pheno_type=</span>my_color)</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw">pheatmap</span>(mat, <span class="dt">annotation_row=</span>annotation_row,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">         <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">cellwidth=</span><span class="dv">16</span>,</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">         <span class="dt">fontsize=</span><span class="dv">10</span>, <span class="dt">fontsize_row=</span><span class="dv">6</span>, <span class="dt">angle_col=</span><span class="dv">90</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">         <span class="dt">annotation_colors=</span>annotation_colors)</a></code></pre></div>
<p><img src="gitbook_files/figure-html/comb-cohort-7-factors-heatmap-1.png" width="672" /></p>
<p><strong>Rearrange samples by clusters</strong>
Rearrange the samples based on the FSHD elevation in classical/terminal and alternative pathways.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># rearrange heatmap by the clust</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">hc &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(mat))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">branch &lt;-<span class="st"> </span><span class="kw">cutree</span>(hc, <span class="dt">k=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">lables=</span>hc<span class="op">$</span>labels, <span class="dt">order=</span>hc<span class="op">$</span>order, <span class="dt">tree=</span>branch) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tree=</span><span class="kw">ifelse</span>(lables <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F15B&quot;</span>, <span class="st">&quot;F16B&quot;</span>, <span class="st">&quot;F53&quot;</span>),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                     <span class="fl">3.5</span>, tree)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">  </span><span class="kw">arrange</span>(order) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tree=</span><span class="kw">factor</span>(tree, <span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="fl">3.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="st">  </span><span class="kw">arrange</span>(tree) </a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co"># define gaps_row</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">gaps_row &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(tree) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n=</span>dplyr<span class="op">::</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">gaps=</span><span class="kw">cumsum</span>(n))</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">annotation_colors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">pheno_type=</span>my_color)</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="kw">pheatmap</span>(<span class="dt">mat=</span>mat[df<span class="op">$</span>lables, ], </a>
<a class="sourceLine" id="cb14-17" data-line-number="17">         <span class="dt">annotation_row=</span>annotation_row[df<span class="op">$</span>lables, , <span class="dt">drop=</span><span class="ot">FALSE</span>],</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">         <span class="dt">annotation_colors=</span>annotation_colors,</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">         <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">cellwidth=</span><span class="dv">16</span>, <span class="dt">gaps_row=</span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">70</span>),</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">         <span class="dt">cluster_rows=</span><span class="ot">FALSE</span>, <span class="dt">angle_col=</span><span class="dv">90</span>,</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">         <span class="dt">fontsize=</span><span class="dv">10</span>, <span class="dt">fontsize_row=</span><span class="dv">6</span>)</a></code></pre></div>
<div class="figure"><span id="fig:rearragne-heatmap"></span>
<img src="gitbook_files/figure-html/rearragne-heatmap-1.png" alt="Heatmap of panel 7 (Suppl Fig 3e. Arrange the samples by clusters of elevated FSHDs in different pathways." width="672" />
<p class="caption">
Figure 3.5: Heatmap of panel 7 (Suppl Fig 3e. Arrange the samples by clusters of elevated FSHDs in different pathways.
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">pheatmap</span>(<span class="dt">mat=</span>mat[df<span class="op">$</span>lables, ], </a>
<a class="sourceLine" id="cb15-2" data-line-number="2">         <span class="dt">annotation_row=</span>annotation_row[df<span class="op">$</span>lables, , <span class="dt">drop=</span><span class="ot">FALSE</span>],</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">         <span class="dt">annotation_colors=</span>annotation_colors,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">         <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">cellwidth=</span><span class="dv">16</span>, <span class="dt">gaps_row=</span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">70</span>),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">         <span class="dt">cluster_rows=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">         <span class="dt">fontsize=</span><span class="dv">10</span>, <span class="dt">fontsize_row=</span><span class="dv">6</span>, <span class="dt">slient=</span><span class="ot">TRUE</span>, <span class="dt">angle_col=</span><span class="dv">90</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">         <span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">                        <span class="st">&quot;comb-cohort-heatmap-panel7-arranged.pdf&quot;</span>))</a></code></pre></div>
</div>
<div id="composite-z-score" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Composite z-score</h3>
<p>The per-sample composite z-score is the sum of z-scores of selected complement components: <span class="math inline">\(S_i = \sum_{i=1}^{m} Z_{i,j}\)</span>, where <span class="math inline">\(j\)</span> denotes the complement, m the number of selected complements, and <span class="math inline">\(Z_{i,j}\)</span> the normalized value (z-score). It gives a 1D projection of how each sample deviates up or down from each other. Using this score, we can observe difference between FSHD and controls.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sample_zscore &lt;-<span class="st"> </span>comb_tidy_norm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(complement <span class="op">%in%</span><span class="st"> </span><span class="kw">all_of</span>(panel_<span class="dv">7</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">composite_zscore=</span><span class="kw">sum</span>(ml_norm, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">left_join</span>(dplyr<span class="op">::</span><span class="kw">select</span>(comb, <span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>), <span class="dt">by=</span><span class="st">&quot;sample ID&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(composite_zscore)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="dt">levels=</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>))</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">sample_zscore_<span class="dv">7</span> &lt;-<span class="st"> </span>sample_zscore</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="kw">ggplot</span>(sample_zscore, </a>
<a class="sourceLine" id="cb16-11" data-line-number="11">       <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="dt">y=</span>composite_zscore, <span class="dt">fill=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;composite z-score (7)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size=</span><span class="dv">7</span>), </a>
<a class="sourceLine" id="cb16-17" data-line-number="17">        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-18" data-line-number="18">        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&#39;cm&#39;</span>),</a>
<a class="sourceLine" id="cb16-19" data-line-number="19">        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>), </a>
<a class="sourceLine" id="cb16-20" data-line-number="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<div class="figure"><span id="fig:panel7-score-waterfall-plot"></span>
<img src="gitbook_files/figure-html/panel7-score-waterfall-plot-1.png" alt="Composite z-score usign seven selected complement components." width="672" />
<p class="caption">
Figure 3.6: Composite z-score usign seven selected complement components.
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">        <span class="co">#panel.grid.major = element_blank())</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                      <span class="st">&quot;comb-cohort-composite-zscore-waterfall-panel7.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">       <span class="dt">width=</span><span class="fl">6.5</span>, <span class="dt">height=</span><span class="dv">3</span>)  </a></code></pre></div>
<p><strong>t-test between FSHD and controls</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">pval &lt;-<span class="st"> </span>sample_zscore <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>, composite_zscore) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pval=</span><span class="kw">t.test</span>(FSHD, Control)<span class="op">$</span>p.value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(pval)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">ggplot</span>(sample_zscore, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>, <span class="dt">y=</span>composite_zscore)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">color=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>), <span class="dt">width=</span><span class="fl">0.7</span>, <span class="dt">outlier.shape=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">               <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Composite z-score (7)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">1.5</span>, <span class="dt">y =</span> <span class="fl">8.75</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">           <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;pval=&quot;</span>, <span class="kw">format</span>(pval, <span class="dt">digits=</span><span class="dv">2</span>)))</a></code></pre></div>
<div class="figure"><span id="fig:composite-zscore-ttest-panal7"></span>
<img src="gitbook_files/figure-html/composite-zscore-ttest-panal7-1.png" alt="Composite zscore by sample groups (Suppl. Fig. 3f)." width="672" />
<p class="caption">
Figure 3.7: Composite zscore by sample groups (Suppl. Fig. 3f).
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;comb-cohort-composite-score-boxplot-panel7.pdf&quot;</span>), <span class="dt">width=</span><span class="dv">2</span>, <span class="dt">height=</span><span class="dv">3</span>)</a></code></pre></div>
<p>Visualization by PCA ??</p>
</div>
</div>
<div id="panel-of-four---classification-and-composite-z-scores" class="section level2">
<h2><span class="header-section-number">3.3</span> Panel of four - Classification and composite z-scores</h2>
<p>We selected four best componets out of the panel of seven that are most associated with FSHD (C3, C4b, Facter D and sC5b-9). We performed similar analysis as above and made boxplots of panel of four, heatmap/cluster, waterfall and boxplots of composite z-score (4).</p>
<p>The code chunks below made Fig. 4a-d.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">panel_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;C3&quot;</span>, <span class="st">&quot;C4b&quot;</span>, <span class="st">&quot;Factor D&quot;</span>, <span class="st">&quot;sC5b-9&quot;</span>)</a></code></pre></div>
<div id="boxplot-by-sample-groups-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Boxplot by sample groups</h3>
<p><strong>boxplot:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">comb_tidy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(complement <span class="op">%in%</span><span class="st"> </span><span class="kw">all_of</span>(panel_<span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pheno_type, <span class="dt">y=</span>ml)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">color=</span>pheno_type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, </a>
<a class="sourceLine" id="cb21-6" data-line-number="6">                 <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>, <span class="dt">dotsize=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb21-7" data-line-number="7">                 <span class="kw">aes</span>(<span class="dt">color=</span>pheno_type, <span class="dt">fill=</span>pheno_type), </a>
<a class="sourceLine" id="cb21-8" data-line-number="8">                 <span class="dt">alpha=</span><span class="fl">0.7</span>, <span class="dt">show.legend=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun=</span>mean, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">23</span>, <span class="dt">size=</span><span class="fl">2.5</span>,</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">                 <span class="dt">color=</span>mean_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>complement , <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>, <span class="dt">nrow=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb21-16" data-line-number="16">          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(mu<span class="op">*</span>g <span class="op">/</span><span class="st"> </span>ml), </a>
<a class="sourceLine" id="cb21-18" data-line-number="18">         <span class="dt">title=</span><span class="st">&quot;Combind cohort: selected panel&quot;</span>) </a></code></pre></div>
<div class="figure"><span id="fig:comb-cohort-boxplot-panel4"></span>
<img src="gitbook_files/figure-html/comb-cohort-boxplot-panel4-1.png" alt="Violin plot of the panel of four by sample groups." width="672" />
<p class="caption">
Figure 3.8: Violin plot of the panel of four by sample groups.
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                      <span class="st">&quot;comb-cohort-violin-panel4-violin.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">       <span class="dt">width=</span><span class="dv">5</span>, <span class="dt">height=</span><span class="fl">2.5</span>)</a></code></pre></div>
</div>
<div id="heatmapclustering-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Heatmap/clustering</h3>
<p>The hiearchical clustering is able to distinguish elevated FSHDs from controls and other “cold” FSHDs.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># the rows could be re-arrange by defined clusters (cold fhsd, hot on terminal and alternative)</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">norm_data &lt;-<span class="st"> </span>comb_tidy_norm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>ml) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span><span class="kw">spread</span>(complement, ml_norm) </a>
<a class="sourceLine" id="cb23-4" data-line-number="4">mat &lt;-<span class="st"> </span>norm_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">all_of</span>(panel_<span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw">rownames</span>(mat) &lt;-<span class="st"> </span>norm_data<span class="op">$</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7">annotation_row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pheno_type=</span><span class="kw">factor</span>(<span class="kw">pull</span>(norm_data, <span class="st">`</span><span class="dt">pheno_type</span><span class="st">`</span>)))</a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">rownames</span>(annotation_row) &lt;-<span class="st"> </span><span class="kw">rownames</span>(mat)</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">annotation_colors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">pheno_type=</span>my_color)</a>
<a class="sourceLine" id="cb23-10" data-line-number="10"></a>
<a class="sourceLine" id="cb23-11" data-line-number="11">phm &lt;-<span class="st"> </span><span class="kw">pheatmap</span>(mat, <span class="dt">annotation_row=</span>annotation_row,</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">         <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">cellwidth=</span><span class="dv">16</span>,</a>
<a class="sourceLine" id="cb23-13" data-line-number="13">         <span class="dt">fontsize=</span><span class="dv">10</span>, <span class="dt">fontsize_row=</span><span class="dv">6</span>, <span class="dt">angle_col =</span> <span class="dv">90</span>,</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">         <span class="dt">annotation_colors=</span>annotation_colors)</a></code></pre></div>
<div class="figure"><span id="fig:comb-cohort-4-factors-heatmap"></span>
<img src="gitbook_files/figure-html/comb-cohort-4-factors-heatmap-1.png" alt="Heatmap and clustering using panel of four components." width="672" />
<p class="caption">
Figure 3.9: Heatmap and clustering using panel of four components.
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">pheatmap</span>(mat[phm<span class="op">$</span>tree_row<span class="op">$</span>order, ], <span class="dt">annotation_row=</span>annotation_row,</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">         <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>, <span class="dt">cellwidth=</span><span class="dv">16</span>,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">         <span class="dt">gaps_row =</span> <span class="kw">c</span>(<span class="dv">17</span>, <span class="dv">70</span>), <span class="dt">treeheight_row=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">         <span class="dt">annotation_colors=</span>annotation_colors, </a>
<a class="sourceLine" id="cb24-5" data-line-number="5">         <span class="dt">fontsize=</span><span class="dv">10</span>, <span class="dt">fontsize_row=</span><span class="dv">6</span>, <span class="dt">slient=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">         <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>, <span class="dt">angle_col=</span><span class="dv">90</span>,</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">         <span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, </a>
<a class="sourceLine" id="cb24-8" data-line-number="8">                        <span class="st">&quot;comb-cohort-heatmap-panel4-arranged.pdf&quot;</span>))</a></code></pre></div>
</div>
<div id="composite-z-score-1" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Composite z-score</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">sample_zscore &lt;-<span class="st"> </span>comb_tidy_norm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(complement <span class="op">%in%</span><span class="st"> </span><span class="kw">all_of</span>(panel_<span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">composite_zscore=</span><span class="kw">sum</span>(ml_norm, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw">left_join</span>(dplyr<span class="op">::</span><span class="kw">select</span>(comb, <span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>), <span class="dt">by=</span><span class="st">&quot;sample ID&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(composite_zscore)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="dt">levels=</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>))</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">sample_zscore_<span class="dv">4</span> &lt;-<span class="st"> </span>sample_zscore</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="kw">ggplot</span>(sample_zscore, </a>
<a class="sourceLine" id="cb25-11" data-line-number="11">       <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="dt">y=</span>composite_zscore, <span class="dt">fill=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;composite z-score (4)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size=</span><span class="dv">7</span>), </a>
<a class="sourceLine" id="cb25-17" data-line-number="17">        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&#39;cm&#39;</span>),</a>
<a class="sourceLine" id="cb25-19" data-line-number="19">        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>), </a>
<a class="sourceLine" id="cb25-20" data-line-number="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<div class="figure"><span id="fig:panel4-score-waterfall-plot"></span>
<img src="gitbook_files/figure-html/panel4-score-waterfall-plot-1.png" alt="Composite z-score usign seven selected complement components." width="672" />
<p class="caption">
Figure 3.10: Composite z-score usign seven selected complement components.
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">        <span class="co">#panel.grid.major = element_blank())</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                      <span class="st">&quot;comb-cohort-composite-zscore-waterfall-panel4.pdf&quot;</span>),</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">       <span class="dt">width=</span><span class="fl">6.5</span>, <span class="dt">height=</span><span class="fl">2.5</span>)  </a></code></pre></div>
<p><strong>t-test between FSHD and controls</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">pval &lt;-<span class="st"> </span>sample_zscore <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>, composite_zscore) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pval=</span><span class="kw">t.test</span>(FSHD, Control)<span class="op">$</span>p.value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(pval)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="kw">ggplot</span>(sample_zscore, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>, <span class="dt">y=</span>composite_zscore)) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">color=</span><span class="st">`</span><span class="dt">pheno type</span><span class="st">`</span>), <span class="dt">width=</span><span class="fl">0.7</span>, <span class="dt">outlier.shape=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">               <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>my_color) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Composite z-score (4)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">1.5</span>, <span class="dt">y =</span> <span class="fl">8.75</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">           <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;pval=&quot;</span>, <span class="kw">format</span>(pval, <span class="dt">digits=</span><span class="dv">2</span>)))</a></code></pre></div>
<div class="figure"><span id="fig:composite-zscore-ttest-panal4"></span>
<img src="gitbook_files/figure-html/composite-zscore-ttest-panal4-1.png" alt="Boxplot of composite z-score by sample groups" width="672" />
<p class="caption">
Figure 3.11: Boxplot of composite z-score by sample groups
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">file.path</span>(pkg_dir, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;comb-cohort-composite-score-boxplot-panel4.pdf&quot;</span>), <span class="dt">width=</span><span class="dv">2</span>, <span class="dt">height=</span><span class="dv">3</span>)</a></code></pre></div>
</div>
</div>
<div id="clinical-severity-score-and-d4z4-repeats" class="section level2">
<h2><span class="header-section-number">3.4</span> Clinical severity score and D4Z4 repeats</h2>
<p>We determined whether Clinical Severity Score (CSS) or D4Z4 repeat number are correlated with complement levels by using Pearson correlation test. Code chunks below yield the results.</p>
<div id="css-vs.composite-z-score" class="section level3">
<h3><span class="header-section-number">3.4.1</span> CSS vs. composite z-score</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">tmp &lt;-<span class="st"> </span><span class="kw">.tidy_names</span>(comb) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, CSS) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(sample_zscore, <span class="dt">by=</span><span class="st">&quot;sample ID&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(CSS))</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co"># CSS vs. composite_zscore (4)</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="kw">cor</span>(tmp<span class="op">$</span>CSS, tmp<span class="op">$</span>composite_zscore)  </a></code></pre></div>
<pre><code>## [1] 0.1953605</code></pre>
</div>
<div id="d4z4-vs.composite-z-score" class="section level3">
<h3><span class="header-section-number">3.4.2</span> D4Z4 vs. composite z-score</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">tmp &lt;-<span class="st"> </span><span class="kw">.tidy_names</span>(comb) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">sample ID</span><span class="st">`</span>, <span class="st">`</span><span class="dt">D4Z4 Repeats</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(sample_zscore, <span class="dt">by=</span><span class="st">&quot;sample ID&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(<span class="st">`</span><span class="dt">D4Z4 Repeats</span><span class="st">`</span>))</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="co"># CSS vs. composite_zscore (4)</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="kw">cor</span>(tmp<span class="op">$</span><span class="st">`</span><span class="dt">D4Z4 Repeats</span><span class="st">`</span>, tmp<span class="op">$</span>composite_zscore)  </a></code></pre></div>
<pre><code>## [1] -0.1356572</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="second-cohort.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-combined-cohort.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "git@github.com:FredHutch/Wellstone_Plasma_Complement_in_FSHD.git03-combined-cohort.Rmd",
"text": null
},
"download": ["gitbook.pdf", "gitbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
